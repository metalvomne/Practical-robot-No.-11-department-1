import pandas as pd

# === 1. Початкові дані зі словника (Практична №5) ===
employees = {
    "Іванов": "м. Київ, вул. Хрещатик, 10",
    "Петров": "м. Львів, вул. Зелена, 25",
    "Сидоров": "м. Харків, вул. Наукова, 7",
    "Кузін": "м. Дніпро, вул. Центральна, 15",
    "Кульков": "м. Одеса, вул. Французький бульвар, 3",
    "Кудін": "м. Чернігів, вул. Перемоги, 9",
    "Шевченко": "м. Київ, вул. Лесі Українки, 20",
    "Кубиків": "м. Полтава, вул. Київська, 14",
    "Куравльов": "м. Суми, вул. Соборна, 8",
    "Мельник": "м. Рівне, вул. Вишнева, 12"
}

# === 2. Доповнення даними про посаду, відділ, зарплату, кількість проєктів ===
data = {
    "Прізвище": list(employees.keys()),
    "Адреса": list(employees.values()),
    "Посада": [
        "Менеджер", "Інженер", "Програміст", "Аналітик", "Бухгалтер",
        "Дизайнер", "HR-менеджер", "Маркетолог", "Тестувальник", "Архітектор"
    ],
    "Відділ": [
        "Продажі", "Виробництво", "IT", "Аналітика", "Бухгалтерія",
        "Дизайн", "Кадри", "Маркетинг", "IT", "Проєкти"
    ],
    "Зарплата": [15000, 18000, 25000, 20000, 16000, 17000, 14000, 19000, 15500, 21000],
    "Кількість_проєктів": [5, 7, 10, 8, 6, 4, 3, 5, 6, 9]
}

# === 3. Створення DataFrame ===
df = pd.DataFrame(data)

print("=== Повний DataFrame ===")
print(df, "\n")

# === 4. Перші 3 рядки DataFrame ===
print("=== Перші 3 рядки DataFrame ===")
print(df.head(3), "\n")

# === 5. Перевірка типів даних ===
print("=== Типи даних ===")
print(df.dtypes, "\n")

# === 6. Кількість рядків і стовпців ===
print("=== Розмірність DataFrame (рядки, стовпці) ===")
print(df.shape, "\n")

# === 7. Описова статистика ===
print("=== Описова статистика числових полів ===")
print(df.describe(), "\n")

# === 8. Додаємо новий стовпець (розрахунковий) ===
df["Загальний_дохід"] = df["Зарплата"] * df["Кількість_проєктів"]

print("=== DataFrame із новим стовпцем 'Загальний_дохід' ===")
print(df, "\n")

# === 9. Фільтрація даних (зарплата > 18000) ===
print("=== Працівники із зарплатою понад 18000 грн ===")
print(df[df["Зарплата"] > 18000], "\n")

# === 10. Сортування за спаданням зарплати ===
print("=== Сортування за спаданням зарплати ===")
print(df.sort_values(by="Зарплата", ascending=False), "\n")

# === 11. Групування за відділами (середня зарплата) ===
print("=== Середня зарплата по відділах ===")
print(df.groupby("Відділ")["Зарплата"].mean(), "\n")

# === 12. Агрегація: макс. дохід та кількість унікальних посад ===
print("=== Агрегація ===")
print("Максимальний загальний дохід:", df["Загальний_дохід"].max())
print("Кількість унікальних посад:", df["Посада"].nunique())
